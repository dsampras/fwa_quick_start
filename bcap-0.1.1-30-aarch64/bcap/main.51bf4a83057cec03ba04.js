(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(t,e,n){t.exports=n("zUnb")},zUnb:function(t,e,n){"use strict";n.r(e);var a=n("fXoL"),s=n("jhN1"),i=n("PqYM"),o=n("NCWt"),c=n.n(o),r=n("eIep"),l=n("LRne"),u=n("yrbL"),h=n("tk/3");let b=(()=>{class t{constructor(t){this.httpClient=t,this.apiRoot="/api"}getStatus(){return this.httpClient.get(this.apiRoot+"/status").pipe(Object(u.catchError)(t=>Object(l.a)({status:"error"})))}startNewCapture(t){return this.httpClient.get(this.apiRoot+"/start/"+t).pipe(Object(u.catchError)(t=>Object(l.a)({status:"error"})))}cancelCapture(t){return this.httpClient.get(this.apiRoot+"/cancel").pipe(Object(u.catchError)(t=>Object(l.a)({status:"error"})))}}return t.\u0275fac=function(e){return new(e||t)(a.Kb(h.a))},t.\u0275prov=a.xb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var d=n("Wp6s"),p=n("ofXK"),f=n("kmnG"),g=n("d3UM"),m=n("bTqV"),v=n("FKr1");const C=["bgGraphic"],G=["controls"],S=["cancelButton"];function F(t,e){1&t&&(a.Gb(0,"div"),a.Gb(1,"mat-card-title"),a.dc(2,"Most Recent Capture"),a.Fb(),a.Gb(3,"mat-card-subtitle"),a.Gb(4,"span",20),a.dc(5,"WAN Interface:"),a.Fb(),a.dc(6," rai0"),a.Fb(),a.Fb())}function x(t,e){1&t&&(a.Gb(0,"div"),a.Gb(1,"mat-card-title"),a.dc(2,"Ready to Capture"),a.Fb(),a.Gb(3,"mat-card-subtitle"),a.Gb(4,"span",20),a.dc(5,"WAN Interface:"),a.Fb(),a.dc(6," rai0"),a.Fb(),a.Fb())}function y(t,e){if(1&t&&(a.Gb(0,"mat-card-content"),a.Gb(1,"div",21),a.Gb(2,"span",22),a.dc(3,"Filename:"),a.Fb(),a.Gb(4,"span",23),a.dc(5),a.Fb(),a.Fb(),a.Gb(6,"div",21),a.Gb(7,"span",22),a.dc(8,"Captured:"),a.Fb(),a.Gb(9,"span",23),a.dc(10),a.Fb(),a.Fb(),a.Gb(11,"div",21),a.Gb(12,"span",22),a.dc(13,"Duration:"),a.Fb(),a.Gb(14,"span",23),a.dc(15),a.Fb(),a.Fb(),a.Gb(16,"div",21),a.Gb(17,"span",22),a.dc(18,"Size:"),a.Fb(),a.Gb(19,"span",23),a.dc(20),a.Fb(),a.Fb(),a.Gb(21,"div",21),a.Gb(22,"span",22),a.dc(23,"Beacon Storage:"),a.Fb(),a.Gb(24,"span",23),a.dc(25),a.Fb(),a.Fb(),a.Fb()),2&t){const t=a.Pb();a.qb(5),a.ec(t.status.file),a.qb(5),a.ec(t.captureTimeFormatted),a.qb(5),a.ec(t.captureDurationFormatted),a.qb(5),a.ec(t.captureSizeFormatted),a.qb(5),a.ec(t.freeStorageFormatted)}}function O(t,e){if(1&t){const t=a.Hb();a.Gb(0,"button",16),a.Nb("click",function(){return a.Wb(t),a.Pb().onDownloadCapture()}),a.dc(1,"Download"),a.Fb()}}function w(t,e){if(1&t&&(a.Gb(0,"mat-option",24),a.dc(1),a.Fb()),2&t){const t=e.$implicit;a.Sb("value",t.value),a.qb(1),a.fc(" ",t.viewValue," ")}}let k=(()=>{class t{constructor(t,e){this.bcapService=t,this.renderer=e,this.bgGraphicWidth=300,this.bgGraphicHeight=700,this.controlsWidth=0,this.controlsHeight=0,this.captureStartTs=0,this.cancelButtonText="Cancel Capture",this.cancelling=!1,this.status={status:"na",file:"",startTs:0,durationSec:0},this.captureLengths=[{value:10,viewValue:"10s"},{value:15,viewValue:"15s"},{value:30,viewValue:"30s"},{value:60,viewValue:"60s"}],this.selectedCaptureLength=30,this.sketch=t=>{var e,n=[],a=!1,s=0,i=0,o=!1,c=!1;t.isStarted=()=>c,t.start=()=>{n=[];for(var r=0,u=0;u<=t.width/14;u++){var h=new l;h.generateSymbols(r,t.random(-2e3,0)),n.push(h),r+=14}i=0,o=!1,e=0,a=!0,s=0,c=!0},t.stop=()=>{a&&(c=!1,a=!1,s=Math.floor(Date.now()/1e3))},t.setup=()=>{let e=t.createCanvas(this.bgGraphicWidth,this.bgGraphicHeight);t.background(0,0,0,0),e.parent("sketch-holder"),t.textFont("Consolas"),t.textSize(14)},t.windowResized=()=>{t.resizeCanvas(this.bgGraphicWidth,this.bgGraphicHeight)},t.draw=()=>{if(t.clear(),n.forEach(function(t){t.render()}),o){let n=Math.floor(Date.now()),o=n-1e3*e;i=o*(t.height/(1e3*this.selectedCaptureLength));let c=255;if(a&&o<=2e3&&(c=o/2e3*255),!a){let t=1e3*s+1200-n;c=t<=0?0:t/1200*255}let r=t.color(0,17,53,c),l=0,u=t.max(0,t.height-i),h=i,b=t.width;t.fill(r),t.rect(l,u,b,h);let d=t.width/2,p=u+50;t.fill(t.color(255,255,255,255,c)),t.stroke(t.color(18,65,145,c)),t.strokeWeight(2);let f="Capturing network traffic ...";0==u&&(f="Writing capture file ..."),this.cancelling&&(f="Cancelling capture ...");let g=t.textSize();t.textSize(23),t.textAlign(t.CENTER),t.text(f,d,p),t.textSize(g)}};class r{constructor(n,s,i,c,r){this.rain=()=>{this.y+=this.speed,a?this.y>=t.height+10&&(e||(o=!0,e=Math.floor(Date.now()/1e3)),this.y=0):this.speed+=2},this.x=n,this.y=s,this.speed=i,this.first=c,this.opacity=r,this.value=t.round(t.random(0,100))>50?"1":"0"}}class l{constructor(){this.symbols=[],this.totalSymbols=t.round(t.random(5,45)),this.speed=t.random(5,22),this.generateSymbols=(e,n)=>{for(var a=255,s=1==t.round(t.random(0,4)),i=0;i<=this.totalSymbols;i++){let t=new r(e,n,this.speed,s,a);this.symbols.push(t),a-=255/this.totalSymbols/1.6,n-=14,s=!1}},this.render=()=>{t.textSize(16),t.noStroke(),this.symbols.forEach(function(e){e.first?t.fill(18,65,145,e.opacity):t.fill(0,17,53,e.opacity),t.text(e.value,e.x,e.y),e.rain()})}}}}}onResize(t){this.updateCanvasSize()}ngAfterViewInit(){this.updateCanvasSize()}updateCanvasSize(){this.bgGraphicWidth=this.bgGraphic.nativeElement.offsetWidth,this.bgGraphicHeight=this.bgGraphic.nativeElement.offsetHeight,this.controlsWidth=this.controls.nativeElement.offsetWidth,this.controlsHeight=this.controls.nativeElement.offsetHeight}fadeControlsIn(){this.controls&&this.controls.nativeElement&&(this.controls.nativeElement.classList.remove("fadeOut"),this.controls.nativeElement.classList.contains("fadeIn")||this.controls.nativeElement.classList.add("fadeIn"))}fadeControlsOut(){this.controls&&this.controls.nativeElement&&(this.controls.nativeElement.classList.remove("fadeIn"),this.controls.nativeElement.classList.contains("fadeOut")||this.controls.nativeElement.classList.add("fadeOut"))}fadeCancelButtonIn(){this.cancelButton&&this.cancelButton.nativeElement&&(this.cancelButton.nativeElement.classList.remove("fadeOut"),this.cancelButton.nativeElement.classList.contains("fadeIn")||this.cancelButton.nativeElement.classList.add("fadeIn"))}fadeCancelButtonOut(){this.cancelButton&&this.cancelButton.nativeElement&&(this.cancelButton.nativeElement.classList.remove("fadeIn"),this.cancelButton.nativeElement.classList.contains("fadeOut")||this.cancelButton.nativeElement.classList.add("fadeOut"))}get hasCapture(){return this.status&&"none"!=this.status.status}ngOnInit(){this.canvas=new c.a(this.sketch),Object(i.a)(0,4e3).pipe(Object(r.a)(()=>this.bcapService.getStatus())).subscribe(t=>{console.log(t),this.status=t,"started"!=this.status.status&&"active"!=this.status.status?(console.log("Stopping animation"),this.fadeControlsIn(),this.canvas.stop(),this.fadeCancelButtonOut()):this.canvas.isStarted()||this.canvas.start()})}get showControls(){return!0}get captureTimeFormatted(){if(this.status&&this.status.startTs){let t=new Date(1e3*this.status.startTs);return t.toLocaleDateString()+" | "+t.toLocaleTimeString()}return"n/a"}get captureDurationFormatted(){return this.status&&this.status.durationSec?this.status.durationSec.toLocaleString()+" seconds":"n/a"}get captureSizeFormatted(){return this.status&&this.status.durationSec?this.status.fileSize.toLocaleString()+" bytes":"n/a"}get freeStorageFormatted(){return this.status&&this.status.freeStorage?this.status.freeStorage.toLocaleString():"n/a"}onDownloadCapture(){const t=document.createElement("a");t.setAttribute("target","_self"),t.setAttribute("href","/data/"+this.status.file),t.setAttribute("download",this.status.file),document.body.appendChild(t),t.click(),t.remove()}onCancelCapture(){console.log("CANCEL!"),this.cancelButtonText="Cancelling capture ...",this.cancelling=!0,this.fadeCancelButtonOut(),this.bcapService.cancelCapture(this.selectedCaptureLength).subscribe(t=>{console.log(t)})}onStartNewCapture(){this.bcapService.startNewCapture(this.selectedCaptureLength).subscribe(t=>{console.log(t),this.status=t,this.captureStartTs=this.status.startTs,this.cancelButtonText="Cancel Capture",this.cancelling=!1,this.fadeCancelButtonIn(),"started"==this.status.status&&(this.canvas.start(),this.fadeControlsOut(),console.log("Starting animation"))})}}return t.\u0275fac=function(e){return new(e||t)(a.Bb(b),a.Bb(a.y))},t.\u0275cmp=a.vb({type:t,selectors:[["app-packet-capture"]],viewQuery:function(t,e){if(1&t&&(a.gc(C,!0),a.gc(G,!0),a.gc(S,!0)),2&t){let t;a.Tb(t=a.Ob())&&(e.bgGraphic=t.first),a.Tb(t=a.Ob())&&(e.controls=t.first),a.Tb(t=a.Ob())&&(e.cancelButton=t.first)}},hostBindings:function(t,e){1&t&&a.Nb("resize",function(t){return e.onResize(t)},!1,a.Vb)},decls:27,vars:7,consts:[[1,"sketch-container"],["id","sketch-holder"],["bgGraphic",""],[1,"controls"],["controls",""],[1,"mat-elevation-z4"],["mat-card-avatar","",1,"card-header-image"],[4,"ngIf","ngIfElse"],["noCapture",""],[4,"ngIf"],[2,"display","flex"],["mat-raised-button","","color","primary",3,"click",4,"ngIf"],[2,"flex","1 1 auto"],[2,"max-height","35px","margin-top","-3px"],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],["mat-raised-button","","color","primary",3,"click"],[1,"cancelButton"],["cancelButton",""],["mat-raised-button","",3,"click"],[2,"font-weight","bold"],[1,"capSection"],[1,"capKey"],[1,"capValue"],[3,"value"]],template:function(t,e){if(1&t&&(a.Gb(0,"div",0),a.Gb(1,"div",1,2),a.Gb(3,"div",3,4),a.Gb(5,"div"),a.Gb(6,"mat-card",5),a.Gb(7,"mat-card-header"),a.Cb(8,"div",6),a.bc(9,F,7,0,"div",7),a.bc(10,x,7,0,"ng-template",null,8,a.cc),a.Fb(),a.bc(12,y,26,5,"mat-card-content",9),a.Gb(13,"mat-card-actions",10),a.bc(14,O,2,0,"button",11),a.Cb(15,"div",12),a.Gb(16,"mat-form-field",13),a.Gb(17,"mat-label"),a.dc(18,"Duration"),a.Fb(),a.Gb(19,"mat-select",14),a.Nb("valueChange",function(t){return e.selectedCaptureLength=t}),a.bc(20,w,2,2,"mat-option",15),a.Fb(),a.Fb(),a.Gb(21,"button",16),a.Nb("click",function(){return e.onStartNewCapture()}),a.dc(22,"Start New Capture"),a.Fb(),a.Fb(),a.Fb(),a.Fb(),a.Fb(),a.Fb(),a.Fb(),a.Gb(23,"div",17,18),a.Gb(25,"button",19),a.Nb("click",function(){return e.onCancelCapture()}),a.dc(26),a.Fb(),a.Fb()),2&t){const t=a.Ub(11);a.qb(9),a.Sb("ngIf",e.hasCapture)("ngIfElse",t),a.qb(3),a.Sb("ngIf",e.hasCapture),a.qb(2),a.Sb("ngIf",e.hasCapture),a.qb(5),a.Sb("value",e.selectedCaptureLength),a.qb(1),a.Sb("ngForOf",e.captureLengths),a.qb(6),a.ec(e.cancelButtonText)}},directives:[d.a,d.e,d.c,p.f,d.b,f.b,f.e,g.a,p.e,m.a,d.h,d.g,d.d,v.e],styles:["[_nghost-%COMP%]{flex:1;align-items:center;flex-direction:column}.sketch-container[_ngcontent-%COMP%], [_nghost-%COMP%]{display:flex;justify-content:center}.sketch-container[_ngcontent-%COMP%]{align-items:stretch;flex:1;width:100%;position:relative}#sketch-holder[_ngcontent-%COMP%]{flex:1}.controls[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;height:400px;width:600px;transform:translate(-50%,-50%)}.capSection[_ngcontent-%COMP%]{display:flex}.capKey[_ngcontent-%COMP%]{flex-basis:20%;font-weight:700}.capValue[_ngcontent-%COMP%]{margin-left:8px;font-weight:400}.card-header-image[_ngcontent-%COMP%]{background-image:url(/assets/data2.svg);background-size:contain;background-repeat:no-repeat}.fadeOut[_ngcontent-%COMP%]{opacity:0!important;transition:all 1s ease-out}.fadeIn[_ngcontent-%COMP%]{opacity:1!important;transition:all 3.5s ease-in-out}.cancelButton[_ngcontent-%COMP%]{opacity:0;position:absolute;top:96%;width:100%;text-align:center}"]}),t})(),E=(()=>{class t{constructor(){this.title="bcap"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=a.vb({type:t,selectors:[["app-root"]],decls:8,vars:0,consts:[[1,"content"],[1,"logo-container"],[1,"logo"],[1,"header-text"],[1,"divider"]],template:function(t,e){1&t&&(a.Gb(0,"div",0),a.Gb(1,"div",1),a.Cb(2,"div",2),a.Fb(),a.Gb(3,"div",3),a.Gb(4,"span"),a.dc(5,"Beacon 6 Packet Capture Diagnostic Utility"),a.Fb(),a.Fb(),a.Cb(6,"div",4),a.Cb(7,"app-packet-capture"),a.Fb())},directives:[k],styles:["",'[_nghost-%COMP%] {\n    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";\n    font-size: 14px;\n    color: #333;\n    box-sizing: border-box;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n  }\n\n  .content[_ngcontent-%COMP%] {\n    display:flex;\n    flex-direction: column;\n    height: 100vh;\n  }\n\n  .logo-container[_ngcontent-%COMP%] {\n    display: flex;\n    \n    justify-content: center;    \n  }\n\n  .logo[_ngcontent-%COMP%] {\n    width: 240px;\n    height: 75px;\n    background-image: url(\'assets/nokia/RGB/NOKIA_LOGO_RGB_MR.png\');\n  }\n\n  .header-text[_ngcontent-%COMP%] {\n    display: flex;\n    justify-content: center;\n    font-size: 16px;\n    font-weight: 500;\n  }\n\n  .main[_ngcontent-%COMP%] {\n    display:flex;\n    flex: 1;\n    justify-content: center;\n    align-items: center;\n  }\n\n  .top-spacer[_ngcontent-%COMP%] {\n    align-self: flex-start;\n  }\n\n  .bottom-spacer[_ngcontent-%COMP%] {\n    align-self: flex-end;\n  }\n\n  .center[_ngcontent-%COMP%] {\n    display:flex;\n    max-width: 50%;\n    flex:1;\n    flex-direction: column;\n  }\n\n  .divider[_ngcontent-%COMP%] {\n    margin-top:10px;\n    min-height:2px;\n    background-color:#001135;\n    width:100%;\n  }']}),t})();var M=n("R1ws");let B=(()=>{class t{}return t.\u0275mod=a.zb({type:t,bootstrap:[E]}),t.\u0275inj=a.yb({factory:function(e){return new(e||t)},providers:[],imports:[[s.a,h.b,m.b,d.f,g.b,M.b]]}),t})();Object(a.J)(),s.b().bootstrapModule(B).catch(t=>console.error(t))},zn8P:function(t,e){function n(t){return Promise.resolve().then(function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e})}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="zn8P"}},[[0,0,4]]]);